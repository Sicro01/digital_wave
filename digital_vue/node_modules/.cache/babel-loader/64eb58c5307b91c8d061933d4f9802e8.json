{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport PlanCard from '@/components/plan/PlanCard';\nimport PlanEditDialog from '@/components/dialogs/PlanEditDialog';\nimport axios from 'axios';\nimport store from '@/store';\nexport default {\n  name: 'HomeView',\n  components: {\n    PlanCard,\n    PlanEditDialog\n  },\n  data() {\n    return {\n      isViewPlan: false,\n      message: '',\n      plans: [],\n      plan: '',\n      open_dialog: false,\n      newPlan: {\n        id: -1,\n        name: '',\n        description: ''\n      },\n      editPlan: {\n        id: 0,\n        name: '',\n        description: ''\n      },\n      initialPhase: {\n        name: 'Phase name',\n        description: 'Phase description',\n        start_date: new Date().toISOString().substring(0, 10),\n        end_date: new Date().toISOString().substring(0, 10)\n      }\n    };\n  },\n  mounted() {\n    this.getPlans();\n    document.title = 'Home | Digital Wave';\n  },\n  methods: {\n    async getPlans() {\n      await axios.get('api/v1/plans/').then(response => {\n        this.plans = response.data;\n        console.log('plan data:', this.plans);\n      }).catch(error => {\n        console.log(error);\n      });\n    },\n    async updatePlan(updatePlan) {\n      await axios.put(`api/v1/plans/${updatePlan.id}/`, updatePlan).then(response => {\n        this.$store.dispatch('selectPlan', response.data);\n      }).finally(response => {\n        this.message = '';\n        if (this.isViewPlan) {\n          this.message = '- Initial Phase Added';\n          this.viewPlanDetails();\n        }\n      }).catch(error => {\n        console.log(error);\n      });\n      this.getPlans();\n      const payload = {\n        text: `Successfully updated ${updatePlan.name} ${this.message}`,\n        alerttype: \"success\",\n        contentclass: 'white--text'\n      };\n      this.$store.dispatch('showSnackBar', payload);\n    },\n    async createPlan(createPlan) {\n      var newPlan = {};\n      newPlan = {\n        name: createPlan.name,\n        description: createPlan.description,\n        phases: [this.initialPhase]\n      };\n      console.log('create plan: ', newPlan);\n      await axios.post(`api/v1/plans/`, newPlan).catch(error => {\n        console.log(error);\n      });\n      this.getPlans();\n      const payload = {\n        text: `Successfully created ${newPlan.name}`,\n        alerttype: \"success\",\n        contentclass: 'white--text'\n      };\n      this.$store.dispatch('showSnackBar', payload);\n    },\n    async deletePlan(deletePlan) {\n      await axios.delete(`api/v1/plans/${deletePlan.id}/`).catch(error => {\n        console.log(error);\n      });\n      this.getPlans();\n      const payload = {\n        text: `Successfully deleted ${deletePlan.name}`,\n        alerttype: \"success\",\n        contentclass: 'white--text'\n      };\n      this.$store.dispatch('showSnackBar', payload);\n    },\n    openEditPlanDialog(editPlan) {\n      this.editPlan = editPlan;\n      this.open_dialog = true;\n    },\n    openNewPlanDialog() {\n      this.editPlan = this.newPlan;\n      this.open_dialog = true;\n    },\n    checkPlanPhases(plan) {\n      // Save the selected plan in the Store\n      this.$store.dispatch('selectPlan', plan);\n      this.isViewPlan = true;\n      document.title = this.$store.state.selectedPlan.name + ' | Digital Wave';\n      console.log('checkPlanPhases start: ', this.$store.state.selectedPlan);\n\n      // If it's new plan OR user has deleted all phases then create a dummy phase and update the plan\n      if (!plan.phases.length) {\n        console.log('no phases');\n        plan.phases.push(this.initialPhase);\n        this.updatePlan(plan);\n      } else {\n        this.viewPlanDetails();\n        // this.viewPlan = false\n        // // this.$store.dispatch('selectPlan', plan)\n        // this.$router.push(plan.phases[0].get_absolute_url)\n      }\n    },\n\n    viewPlanDetails() {\n      this.isViewPlan = false;\n      console.log('viewPlanDetailsPhaseAdded', this.$store.state.selectedPlan.phases[0].get_absolute_url);\n      this.$router.push(this.$store.state.selectedPlan.phases[0].get_absolute_url);\n    }\n  }\n};","map":{"version":3,"mappings":";AAgDA;AACA;AACA;AACA;AAEA;EACAA;EACAC;IACAC;IACAC;EACA;EACAC;IACA;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;QACAC;QACAX;QACAY;MACA;MACAC;QACAF;QACAX;QACAY;MACA;MACAE;QACAd;QACAY;QACAG;QACAC;MACA;IACA;EACA;EACAC;IACA;IACAC;EACA;EACAC;IACA;MACA,YACAC,qBACAC;QACA;QACAC;MACA,GACAC;QACAD;MACA;IACA;IACA;MACA,YACAE,kDACAH;QACA;MACA,GACAI;QACA;QACA;UACA;UACA;QACA;MACA,GACAF;QACAD;MACA;MACA;MACA;QAAAI;QAAAC;QAAAC;MAAA;MACA;IACA;IACA;MACA;MACAlB;QACAV;QACAY;QACAiB;MACA;MACAP;MACA,YACAQ,+BACAP;QACAD;MACA;MACA;MACA;QAAAI;QAAAC;QAAAC;MAAA;MACA;IACA;IACA;MACA,YACAG,yCACAR;QACAD;MACA;MACA;MACA;QAAAI;QAAAC;QAAAC;MAAA;MACA;IACA;IACAI;MACA;MACA;IACA;IACAC;MACA;MACA;IACA;IACAC;MACA;MACA;MACA;MACAhB;MACAI;;MAEA;MACA;QACAA;QACAd;QACA;MACA,OACA;QACA;QACA;QACA;QACA;MACA;IACA;;IACA2B;MACA;MACAb;MACA;IACA;EACA;AACA","names":["name","components","PlanCard","PlanEditDialog","data","isViewPlan","message","plans","plan","open_dialog","newPlan","id","description","editPlan","initialPhase","start_date","end_date","mounted","document","methods","get","then","console","catch","put","finally","text","alerttype","contentclass","phases","post","delete","openEditPlanDialog","openNewPlanDialog","checkPlanPhases","viewPlanDetails"],"sourceRoot":"src/views","sources":["HomeView.vue"],"sourcesContent":["<template>\n    <div>\n        <v-row\n            class=\"mt-2 primary--text font-weight-black text-h3\">\n            <v-col md=\"6\" offset=\"3\" class=\"text-center\">\n                <span>Plans</span>\n            </v-col>\n            <v-spacer></v-spacer>\n            <v-col cols=\"2\" class=\"text-right\">\n                <v-btn\n                    class=\"mr-4 primary rounded-0 text-capitalize text-body-1\"\n                    dark\n                    @click=\"openNewPlanDialog\"\n                    depressed>\n                    <v-icon small class=\"mr-2\">mdi-plus</v-icon>\n                    New Plan\n                </v-btn>\n            </v-col>\n        </v-row>\n        <br />\n        <br />\n        <br />\n        <v-row class=\"mb-0 mx-4\">\n            <v-col\n                v-for=\"(plan, index) in plans\" :key=\"plan.id\"\n                lg=\"3\"\n                md=\"4\"\n                sm=12\n                class=\"px-3 py-0\">\n    \n                <PlanCard\n                    :plan=\"plan\"\n                    @open-dialog=\"openEditPlanDialog(plan)\"\n                    @view-details=\"checkPlanPhases(plan)\" />\n    \n            </v-col>\n        </v-row>\n    \n        <PlanEditDialog\n            v-model=\"open_dialog\"\n            :plan=\"editPlan\"\n            @create-plan=\"createPlan\"\n            @update-plan=\"updatePlan\"\n            @delete-plan=\"deletePlan\" />\n    \n    </div>\n</template>\n<script>\nimport PlanCard from '@/components/plan/PlanCard'\nimport PlanEditDialog from '@/components/dialogs/PlanEditDialog'\nimport axios from 'axios'\nimport store from '@/store'\n\nexport default {\n    name: 'HomeView',\n    components: {\n        PlanCard,\n        PlanEditDialog,\n    },\n    data() {\n        return {\n            isViewPlan: false,\n            message: '',\n            plans: [],\n            plan: '',\n            open_dialog: false,\n            newPlan: {\n                id: -1,\n                name: '',\n                description: '',\n            },\n            editPlan: {\n                id: 0,\n                name: '',\n                description: '',\n            },\n            initialPhase: {\n                name: 'Phase name',\n                description: 'Phase description',\n                start_date: new Date().toISOString().substring(0, 10),\n                end_date: new Date().toISOString().substring(0, 10),\n            }\n        }\n    },\n    mounted() {\n        this.getPlans()\n        document.title = 'Home | Digital Wave'\n    },\n    methods: {\n        async getPlans() {\n            await axios\n                .get('api/v1/plans/')\n                .then(response => {\n                    this.plans = response.data\n                    console.log('plan data:', this.plans)\n                })\n                .catch(error => {\n                    console.log(error)\n                })\n        },\n        async updatePlan(updatePlan) {\n            await axios\n                .put(`api/v1/plans/${updatePlan.id}/`, updatePlan)\n                .then(response => {\n                    this.$store.dispatch('selectPlan', response.data)\n                })\n                .finally(response => {\n                    this.message = ''\n                    if (this.isViewPlan) {\n                        this.message = '- Initial Phase Added'\n                        this.viewPlanDetails()\n                    }\n                })\n                .catch(error => {\n                    console.log(error)\n                })\n            this.getPlans()\n            const payload = { text: `Successfully updated ${updatePlan.name} ${this.message}`, alerttype: \"success\", contentclass: 'white--text' }\n            this.$store.dispatch('showSnackBar', payload)\n        },\n        async createPlan(createPlan) {\n            var newPlan = {}\n            newPlan = {\n                name: createPlan.name,\n                description: createPlan.description,\n                phases: [this.initialPhase]\n            }\n            console.log('create plan: ', newPlan)\n            await axios\n                .post(`api/v1/plans/`, newPlan)\n                .catch(error => {\n                    console.log(error)\n                })\n            this.getPlans()\n            const payload = { text: `Successfully created ${newPlan.name}`, alerttype: \"success\", contentclass: 'white--text' }\n            this.$store.dispatch('showSnackBar', payload)\n        },\n        async deletePlan(deletePlan) {\n            await axios\n                .delete(`api/v1/plans/${deletePlan.id}/`)\n                .catch(error => {\n                    console.log(error)\n                })\n            this.getPlans()\n            const payload = { text: `Successfully deleted ${deletePlan.name}`, alerttype: \"success\", contentclass: 'white--text' }\n            this.$store.dispatch('showSnackBar', payload)\n        },\n        openEditPlanDialog(editPlan) {\n            this.editPlan = editPlan\n            this.open_dialog = true\n        },\n        openNewPlanDialog() {\n            this.editPlan = this.newPlan\n            this.open_dialog = true\n        },\n        checkPlanPhases(plan) {\n            // Save the selected plan in the Store\n            this.$store.dispatch('selectPlan', plan)\n            this.isViewPlan = true\n            document.title = this.$store.state.selectedPlan.name + ' | Digital Wave'\n            console.log('checkPlanPhases start: ', this.$store.state.selectedPlan)\n\n            // If it's new plan OR user has deleted all phases then create a dummy phase and update the plan\n            if (!plan.phases.length) {\n                console.log('no phases')\n                plan.phases.push(this.initialPhase)\n                this.updatePlan(plan)\n            }\n            else {\n                this.viewPlanDetails()\n                // this.viewPlan = false\n                // // this.$store.dispatch('selectPlan', plan)\n                // this.$router.push(plan.phases[0].get_absolute_url)\n            }\n        },\n        viewPlanDetails() {\n            this.isViewPlan = false\n            console.log('viewPlanDetailsPhaseAdded', this.$store.state.selectedPlan.phases[0].get_absolute_url)\n            this.$router.push(this.$store.state.selectedPlan.phases[0].get_absolute_url)\n        },\n    }\n}\n</script>"]},"metadata":{},"sourceType":"module"}